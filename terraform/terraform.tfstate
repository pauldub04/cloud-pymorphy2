{
  "version": 4,
  "terraform_version": "1.12.1",
  "serial": 14,
  "lineage": "599d695a-2ec3-790a-fa97-c601c11fcd06",
  "outputs": {
    "app_ip": {
      "value": "10.20.14.123",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "rustack_firewall_template",
      "name": "morph_allow_egress",
      "provider": "provider[\"terraform.rustack.ru/rustack-cloud-platform/rcp\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "00000000-0000-0000-0000-000000000000",
            "name": "Разрешить исходящие",
            "vdc_id": "2e22cd19-0e93-4a80-9379-1346c0168d1d"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "data",
      "type": "rustack_firewall_template",
      "name": "morph_allow_ingress",
      "provider": "provider[\"terraform.rustack.ru/rustack-cloud-platform/rcp\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "df633cc8-571f-48b2-a4bf-5ed5ebf47abf",
            "name": "Разрешить входящие",
            "vdc_id": "2e22cd19-0e93-4a80-9379-1346c0168d1d"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "data",
      "type": "rustack_firewall_template",
      "name": "morph_ssh",
      "provider": "provider[\"terraform.rustack.ru/rustack-cloud-platform/rcp\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "7496a065-2bad-4bae-83a1-793f1c609a6e",
            "name": "Разрешить SSH",
            "vdc_id": "2e22cd19-0e93-4a80-9379-1346c0168d1d"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "data",
      "type": "rustack_firewall_template",
      "name": "morph_web",
      "provider": "provider[\"terraform.rustack.ru/rustack-cloud-platform/rcp\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "072386da-6719-4e2f-9f1f-1451200d3f75",
            "name": "Разрешить WEB",
            "vdc_id": "2e22cd19-0e93-4a80-9379-1346c0168d1d"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "data",
      "type": "rustack_hypervisor",
      "name": "kvm",
      "provider": "provider[\"terraform.rustack.ru/rustack-cloud-platform/rcp\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "c617c862-6897-425e-acfa-920096afed5d",
            "name": "РУСТЭК",
            "project_id": "4270dde2-55b5-4214-8776-8b12eec2a952",
            "type": "kvm"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "data",
      "type": "rustack_network",
      "name": "morph_network",
      "provider": "provider[\"terraform.rustack.ru/rustack-cloud-platform/rcp\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "bb59470a-ac1c-4bf1-b399-3b5047166736",
            "mtu": 1500,
            "name": "Сеть",
            "subnets": [
              {
                "cidr": "10.0.1.0/24",
                "dhcp": true,
                "dns": [
                  "77.88.8.8"
                ],
                "end_ip": "10.0.1.254",
                "gateway": "10.0.1.1",
                "id": "6c1da097-3865-466a-8280-fde91fc473f2",
                "start_ip": "10.0.1.2"
              }
            ],
            "vdc_id": "2e22cd19-0e93-4a80-9379-1346c0168d1d"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "data",
      "type": "rustack_project",
      "name": "project",
      "provider": "provider[\"terraform.rustack.ru/rustack-cloud-platform/rcp\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "4270dde2-55b5-4214-8776-8b12eec2a952",
            "name": "Дубняков ПН Б22-544 ЛР"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "data",
      "type": "rustack_storage_profile",
      "name": "morph_ssd",
      "provider": "provider[\"terraform.rustack.ru/rustack-cloud-platform/rcp\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "c9f812ec-c340-4edc-b824-45a5b5213331",
            "name": "SSD",
            "vdc_id": "2e22cd19-0e93-4a80-9379-1346c0168d1d"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "data",
      "type": "rustack_template",
      "name": "morph_ubuntu20",
      "provider": "provider[\"terraform.rustack.ru/rustack-cloud-platform/rcp\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "1fb0722e-a634-4ebf-870d-51a2f470e258",
            "min_cpu": 1,
            "min_disk": 10,
            "min_ram": 1,
            "name": "Ubuntu 20.04",
            "vdc_id": "2e22cd19-0e93-4a80-9379-1346c0168d1d"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "data",
      "type": "rustack_vdc",
      "name": "morph",
      "provider": "provider[\"terraform.rustack.ru/rustack-cloud-platform/rcp\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "hypervisor": "РУСТЭК",
            "hypervisor_type": "kvm",
            "id": "2e22cd19-0e93-4a80-9379-1346c0168d1d",
            "name": "Morphology",
            "project_id": "4270dde2-55b5-4214-8776-8b12eec2a952"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "managed",
      "type": "rustack_port",
      "name": "morph_port",
      "provider": "provider[\"terraform.rustack.ru/rustack-cloud-platform/rcp\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "firewall_templates": [
              "00000000-0000-0000-0000-000000000000",
              "072386da-6719-4e2f-9f1f-1451200d3f75",
              "7496a065-2bad-4bae-83a1-793f1c609a6e",
              "df633cc8-571f-48b2-a4bf-5ed5ebf47abf"
            ],
            "id": "04c8af59-cd58-47e7-aaba-415cfac874a0",
            "ip_address": "10.0.1.3",
            "network_id": "bb59470a-ac1c-4bf1-b399-3b5047166736",
            "tags": [],
            "timeouts": null,
            "vdc_id": "2e22cd19-0e93-4a80-9379-1346c0168d1d"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.rustack_firewall_template.morph_allow_egress",
            "data.rustack_firewall_template.morph_allow_ingress",
            "data.rustack_firewall_template.morph_ssh",
            "data.rustack_firewall_template.morph_web",
            "data.rustack_network.morph_network",
            "data.rustack_project.project",
            "data.rustack_vdc.morph"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "rustack_vm",
      "name": "morph_vm",
      "provider": "provider[\"terraform.rustack.ru/rustack-cloud-platform/rcp\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "cpu": 4,
            "disks": null,
            "floating": true,
            "floating_ip": "10.20.14.123",
            "id": "39dea60b-dcde-466f-b541-54658d9b5c66",
            "name": "morph_vm",
            "networks": [
              {
                "id": "04c8af59-cd58-47e7-aaba-415cfac874a0",
                "ip_address": "10.0.1.3"
              }
            ],
            "ports": [
              "04c8af59-cd58-47e7-aaba-415cfac874a0"
            ],
            "power": true,
            "ram": 4,
            "system_disk": [
              {
                "external_id": "f9f6b065-0f15-4042-ab56-02f3024c9a37",
                "id": "4304a756-a575-4799-8455-4ef9137e7c05",
                "name": "Основной диск",
                "size": 10,
                "storage_profile_id": "c9f812ec-c340-4edc-b824-45a5b5213331"
              }
            ],
            "tags": null,
            "template_id": "1fb0722e-a634-4ebf-870d-51a2f470e258",
            "timeouts": null,
            "user_data": "#cloud-config\ndebug:\n    verbose: true\npackage_update: true\npackage_upgrade: true\npackages:\n  - apt-transport-https\n  - ca-certificates\n  - curl\n  - gnupg-agent\n  - software-properties-common\n  - git\n\n\nusers:\n  - name: ubuntu\n    sudo: [\"ALL=(ALL) NOPASSWD:ALL\"]\n    groups: [sudo, docker]\n    shell: /bin/bash\n    ssh_authorized_keys:\n      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQChs2uHa3YDyyL5WTOr6pt8+6soH0SxDlOvFPC9t/iEmsOGudt6MsTBMmJAZ2DOrTbU71Iy8FvSuilWBKD+iYIxjHGL/XaMslX1G4d3eAAqRMIo4PcBumGtv6aK1dhfXgsT2lkA8Yl+ARLkETOHE6haMckrZt8J5wkZgTC25Y9n76YpMU5b5D8z8Jze7nljbbyYLVuRSuE5NwJPUeOd8Wkmf0iubnWyJtKVevsHkF67prEh8g9LVZrd587R3Tuj33c5qPNpQ/m2KDD+AweHT1Vduc7FLUB92czEHKDKqnbd3REgsBQQzn+FiQYPy1XGOtB+uMjZ594S3xEpLPWz0qAfFb0Jt96k/kdvAI/7uzZb/4swtiR5o6gnt8FJu7V5DN872KqOmt+mo8fD0WYnmaEMH99syiYbqQmlCb83OdJzuHohVgSXKm6/OJOs9cOH1ixCjtyZCDihrr+ZmTqavh3kuV+as3TtQiha5RsaroxJ3hNhBT+GaI6VNUy4S12Kpxs= pdubnyakov@pdubnyakov-nix-2025-05-22\n\nwrite_files:\n- path: /opt/app/docker-compose.yml\n  encoding: b64\n  content: c2VydmljZXM6CiAgYmFja2VuZDoKICAgIGltYWdlOiBwZHVibnlha292L21vcnBoLWJhY2tlbmQ6bGF0ZXN0CiAgICBwb3J0czoKICAgICAgLSAiODAwMDo4MDAwIgogICAgbmV0d29ya3M6CiAgICAgIC0gYXBwLW5ldHdvcmsKCiAgZnJvbnRlbmQ6CiAgICBpbWFnZTogbmdpbng6YWxwaW5lCiAgICBwb3J0czoKICAgICAgLSAiODA6ODAiCiAgICB2b2x1bWVzOgogICAgICAtIC4vZnJvbnRlbmQ6L3Vzci9zaGFyZS9uZ2lueC9odG1sCiAgICAgIC0gLi9uZ2lueC5jb25mOi9ldGMvbmdpbngvY29uZi5kL2RlZmF1bHQuY29uZgogICAgZGVwZW5kc19vbjoKICAgICAgLSBiYWNrZW5kCiAgICBuZXR3b3JrczoKICAgICAgLSBhcHAtbmV0d29yawoKbmV0d29ya3M6CiAgYXBwLW5ldHdvcms6Cg==\n- path: /opt/app/nginx.conf\n  encoding: b64\n  content: ICAgIHNlcnZlciB7CiAgICAgICAgbGlzdGVuIDgwOwogICAgICAgIGNoYXJzZXQgdXRmLTg7CiAgICAgICAgc2VydmVyX25hbWUgbG9jYWxob3N0OwoKICAgICAgICBhZGRfaGVhZGVyICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nICcqJyBhbHdheXM7CiAgICAgICAgYWRkX2hlYWRlciAnQWNjZXNzLUNvbnRyb2wtQWxsb3ctTWV0aG9kcycgJ0dFVCwgUE9TVCwgUFVULCBERUxFVEUsIE9QVElPTlMnIGFsd2F5czsKICAgICAgICBhZGRfaGVhZGVyICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1IZWFkZXJzJyAnRE5ULFVzZXItQWdlbnQsWC1SZXF1ZXN0ZWQtV2l0aCxJZi1Nb2RpZmllZC1TaW5jZSxDYWNoZS1Db250cm9sLENvbnRlbnQtVHlwZSxSYW5nZSxBdXRob3JpemF0aW9uJyBhbHdheXM7CiAgICAgICAgYWRkX2hlYWRlciAnQWNjZXNzLUNvbnRyb2wtRXhwb3NlLUhlYWRlcnMnICdDb250ZW50LUxlbmd0aCxDb250ZW50LVJhbmdlJyBhbHdheXM7CiAgICAgICAgYWRkX2hlYWRlciAnQWNjZXNzLUNvbnRyb2wtTWF4LUFnZScgMTcyODAwMCBhbHdheXM7CgogICAgICAgIGxvY2F0aW9uIC8gewogICAgICAgICAgICByb290IC91c3Ivc2hhcmUvbmdpbngvaHRtbDsKICAgICAgICAgICAgaW5kZXggaW5kZXguaHRtbDsKICAgICAgICAgICAgdHJ5X2ZpbGVzICR1cmkgJHVyaS8gL2luZGV4Lmh0bWw7CiAgICAgICAgfQoKICAgICAgICBsb2NhdGlvbiAvYXBpLyB7CiAgICAgICAgICAgIGlmICgkcmVxdWVzdF9tZXRob2QgPSAnT1BUSU9OUycpIHsKICAgICAgICAgICAgICAgIGFkZF9oZWFkZXIgJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbicgJ2h0dHA6Ly9hcGkubG9jYWxob3N0JzsKICAgICAgICAgICAgICAgIGFkZF9oZWFkZXIgJ0FjY2Vzcy1Db250cm9sLUFsbG93LUNyZWRlbnRpYWxzJyAndHJ1ZSc7CiAgICAgICAgICAgICAgICBhZGRfaGVhZGVyICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1IZWFkZXJzJyAnQXV0aG9yaXphdGlvbixBY2NlcHQsT3JpZ2luLEROVCxYLUN1c3RvbUhlYWRlcixLZWVwLUFsaXZlLFVzZXItQWdlbnQsWC1SZXF1ZXN0ZWQtV2l0aCxJZi1Nb2RpZmllZC1TaW5jZSxDYWNoZS1Db250cm9sLENvbnRlbnQtVHlwZSxDb250ZW50LVJhbmdlLFJhbmdlJzsKICAgICAgICAgICAgICAgIGFkZF9oZWFkZXIgJ0FjY2Vzcy1Db250cm9sLUFsbG93LU1ldGhvZHMnICdHRVQsUE9TVCxPUFRJT05TLFBVVCxERUxFVEUsUEFUQ0gnOwogICAgICAgICAgICAgICAgYWRkX2hlYWRlciAnQWNjZXNzLUNvbnRyb2wtTWF4LUFnZScgMTcyODAwMDsKICAgICAgICAgICAgICAgIGFkZF9oZWFkZXIgJ0NvbnRlbnQtVHlwZScgJ3RleHQvcGxhaW4gY2hhcnNldD1VVEYtOCc7CiAgICAgICAgICAgICAgICBhZGRfaGVhZGVyICdDb250ZW50LUxlbmd0aCcgMDsKICAgICAgICAgICAgICAgIHJldHVybiAyMDQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByb3h5X3Bhc3MgaHR0cDovL2JhY2tlbmQ6ODAwMDsKICAgICAgICAgICAgcHJveHlfcmVkaXJlY3Qgb2ZmOwogICAgICAgICAgICBwcm94eV9zZXRfaGVhZGVyIGhvc3QgJGhvc3Q7CiAgICAgICAgICAgIHByb3h5X3NldF9oZWFkZXIgWC1yZWFsLWlwICRyZW1vdGVfYWRkcjsKICAgICAgICAgICAgcHJveHlfc2V0X2hlYWRlciBYLWZvcndhcmQtZm9yICRwcm94eV9hZGRfeF9mb3J3YXJkZWRfZm9yOwogICAgICAgIH0KICAgIH0=\n- path: /opt/app/frontend/index.html\n  encoding: b64\n  content: PCFET0NUWVBFIGh0bWw+CjxtZXRhIGNoYXJzZXQ9InV0Zi04Ij4KPGh0bWw+CjxoZWFkPgogICAgPHRpdGxlPtCc0L7RgNGE0L7Qu9C+0LPQuNGH0LXRgdC60LjQuSDQsNC90LDQu9C40LfQsNGC0L7RgDwvdGl0bGU+CjwvaGVhZD4KPGJvZHk+CiAgICA8aDE+0JDQvdCw0LvQuNC3INGB0LvQvtCy0LA8L2gxPgogICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJ3b3JkSW5wdXQiPgogICAgPGJ1dHRvbiBvbmNsaWNrPSJhbmFseXplKCkiPtCQ0L3QsNC70LjQt9C40YDQvtCy0LDRgtGMPC9idXR0b24+CiAgICA8ZGl2IGlkPSJyZXN1bHQiPjwvZGl2PgoKICAgIDxzY3JpcHQgc3JjPSJzY3JpcHQuanMiPjwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4=\n- path: /opt/app/frontend/script.js\n  encoding: b64\n  content: YXN5bmMgZnVuY3Rpb24gYW5hbHl6ZSgpIHsKICAgIGNvbnNvbGUubG9nKCdhbmFseXplJyk7CiAgICBjb25zdCB0ZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dvcmRJbnB1dCcpLnZhbHVlOwogICAgCiAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHA6Ly8xMC4yMC4xNC4xMDUvYXBpL2FuYWx5emUnLCB7CiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgICB9LAogICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICB0ZXh0OiB0ZXh0CiAgICAgICAgICAgIH0pCiAgICAgICAgfSk7CiAgICAgICAgCiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIHN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9YCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdWx0JykuaW5uZXJIVE1MID0gSlNPTi5zdHJpbmdpZnkocmVzdWx0LCBudWxsLCAyKTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3I6JywgZXJyb3IpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN1bHQnKS5pbm5lckhUTUwgPSBgRXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gOwogICAgfQp9\n- path: /etc/motd\n  content: |\n    ####################### Morph is installed\n    ####################### http://\u003cIP\u003e:8000\n\nruncmd:\n  - curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\n  - add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\"\n  - apt-get update\n  - DEBIAN_FRONTEND=noninteractive apt-get install -y docker-ce docker-ce-cli containerd.io\n  - systemctl enable docker\n  - systemctl start docker\n\n  - curl -L \"https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\n  - chmod +x /usr/local/bin/docker-compose\n\n  - usermod -aG docker ubuntu\n\n  - cd /opt/app\n  - docker-compose up -d\n",
            "vdc_id": "2e22cd19-0e93-4a80-9379-1346c0168d1d"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.rustack_firewall_template.morph_allow_egress",
            "data.rustack_firewall_template.morph_allow_ingress",
            "data.rustack_firewall_template.morph_ssh",
            "data.rustack_firewall_template.morph_web",
            "data.rustack_network.morph_network",
            "data.rustack_project.project",
            "data.rustack_storage_profile.morph_ssd",
            "data.rustack_template.morph_ubuntu20",
            "data.rustack_vdc.morph",
            "rustack_port.morph_port"
          ]
        }
      ]
    }
  ],
  "check_results": null
}
